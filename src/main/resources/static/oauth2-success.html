<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>OAuth2 Login Success</title>
</head>
<body>
    <p>Login successful. Redirecting...</p>
    <script>
        console.log('OAuth2 Success page loaded');
        console.log('Current URL:', window.location.href);

        // URL에서 'token' 파라미터 값을 추출합니다.
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('token');

        console.log('Token from URL:', token);
        console.log('All URL params:', Array.from(urlParams.entries()));

        if (token) {
            console.log('Token found, saving to localStorage');
            // 토큰을 localStorage에 저장합니다. 프론트엔드에서는 이 토큰을 API 요청 시 사용합니다.
            localStorage.setItem('accessToken', token);
            console.log('Token saved, redirecting to dashboard');

            // 대시보드나 성공 페이지로 리다이렉트 (메인 페이지 대신)
            alert('로그인 성공! 토큰이 저장되었습니다.');
            window.location.href = '/dashboard.html'; // 대시보드가 없다면 메인 페이지로
        } else {
            console.log('No token found in URL');
            // 토큰이 없는 경우, 에러 메시지를 표시하고 로그인 페이지로 보냅니다.
            alert('Authentication failed. No token provided. URL: ' + window.location.href);
            window.location.href = '/';
        }
    </script>
</body>
</html>